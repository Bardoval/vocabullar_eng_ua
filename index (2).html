<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∞–∂–µ—Ä —Å–ª–æ–≤–Ω–∏–∫–æ–≤–æ–≥–æ –∑–∞–ø–∞—Å—É | –ê–Ω–≥–ª—ñ–π—Å—å–∫–∞-–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</title>
    <style>
        :root {
            --primary: #4a6fa5;
            --secondary: #166088;
            --light: #f5f7fa;
            --dark: #333;
            --success: #28a745;
            --danger: #dc3545;
            --warning: #ffc107;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--light);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
        }
        
        h1, h2, h3 {
            color: var(--secondary);
            margin-bottom: 15px;
        }
        
        .container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 20px;
        }
        
        .tabs {
            display: flex;
        }
        
        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: var(--light);
            border: none;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }
        
        .tab.active {
            border-bottom: 2px solid var(--primary);
            font-weight: bold;
            color: var(--primary);
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        input, button, select {
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
            margin: 5px 0;
            width: 100%;
        }
        
        button {
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        button:hover {
            background: var(--secondary);
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        .btn-danger:hover {
            background: #bd2130;
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-success:hover {
            background: #218838;
        }
        
        .word-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .word-info {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        .word-english {
            font-weight: bold;
        }
        
        .word-ukrainian {
            color: #666;
        }
        
        .action-buttons {
            display: flex;
            gap: 5px;
        }
        
        .word-card {
            text-align: center;
            padding: 40px 0;
        }
        
        .word-card-english {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        
        .word-card-ukrainian {
            font-size: 24px;
            color: #666;
            margin-bottom: 20px;
            display: none;
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        
        .stat-card {
            text-align: center;
            padding: 10px;
            flex: 1;
            border-right: 1px solid #eee;
        }
        
        .stat-card:last-child {
            border-right: none;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .stat-label {
            font-size: 14px;
            color: #666;
        }
        
        .progress-container {
            height: 5px;
            background-color: #eee;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .progress-bar {
            height: 100%;
            background-color: var(--primary);
            border-radius: 5px;
            width: 0%;
        }
        
        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .form-row input {
            flex: 1;
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        th, td {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: var(--primary);
            color: white;
        }
        
        tr:hover {
            background-color: #f5f5f5;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 0;
            color: #666;
        }
        
        .flash-card {
            perspective: 1000px;
            margin: 20px 0;
            height: 200px;
        }
        
        .flash-card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
            cursor: pointer;
        }
        
        .flash-card.flipped .flash-card-inner {
            transform: rotateY(180deg);
        }
        
        .flash-card-front, .flash-card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            font-size: 24px;
        }
        
        .flash-card-front {
            background-color: white;
            color: var(--dark);
        }
        
        .flash-card-back {
            background-color: var(--primary);
            color: white;
            transform: rotateY(180deg);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>–¢—Ä–µ–Ω–∞–∂–µ—Ä —Å–ª–æ–≤–Ω–∏–∫–æ–≤–æ–≥–æ –∑–∞–ø–∞—Å—É</h1>
        
        <div class="card">
            <div class="tabs">
                <button class="tab active" data-tab="practice">–ü—Ä–∞–∫—Ç–∏–∫–∞</button>
                <button class="tab" data-tab="dictionary">–°–ª–æ–≤–Ω–∏–∫</button>
                <button class="tab" data-tab="add">–î–æ–¥–∞—Ç–∏ —Å–ª–æ–≤–æ</button>
                <button class="tab" data-tab="stats">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            </div>
            
            <div id="practice" class="tab-content active">
                <div id="practice-empty" class="empty-state">
                    <h3>–ù–µ–º–∞—î —Å–ª—ñ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è</h3>
                    <p>–î–æ–¥–∞–π—Ç–µ –Ω–æ–≤—ñ —Å–ª–æ–≤–∞ –¥–æ —Å–ª–æ–≤–Ω–∏–∫–∞ –∞–±–æ –∑–∞—á–µ–∫–∞–π—Ç–µ, –ø–æ–∫–∏ —ñ—Å–Ω—É—é—á—ñ —Å–ª–æ–≤–∞ –±—É–¥—É—Ç—å –≥–æ—Ç–æ–≤—ñ –¥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è.</p>
                </div>
                
                <div id="practice-content" style="display: none;">
                    <div class="progress-container">
                        <div class="progress-bar" id="practice-progress"></div>
                    </div>
                    
                    <div class="flash-card" id="flashcard">
                        <div class="flash-card-inner">
                            <div class="flash-card-front">
                                <span id="word-english"></span>
                            </div>
                            <div class="flash-card-back">
                                <span id="word-ukrainian"></span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <p>–ö–ª–∞—Ü–Ω—ñ—Ç—å –Ω–∞ –∫–∞—Ä—Ç–∫—É, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –ø–µ—Ä–µ–∫–ª–∞–¥</p>
                    </div>
                    
                    <div style="display: flex; gap: 10px; margin-top: 20px;">
                        <button class="btn-danger" id="btn-forgot">–ó–∞–±—É–≤</button>
                        <button class="btn-success" id="btn-remember">–ü–∞–º'—è—Ç–∞—é</button>
                    </div>
                </div>
            </div>
            
            <div id="dictionary" class="tab-content">
                <div id="dictionary-empty" class="empty-state">
                    <h3>–í–∞—à —Å–ª–æ–≤–Ω–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π</h3>
                    <p>–î–æ–¥–∞–π—Ç–µ –Ω–æ–≤—ñ —Å–ª–æ–≤–∞, —â–æ–± –ø–æ—á–∞—Ç–∏ –Ω–∞–≤—á–∞–Ω–Ω—è.</p>
                </div>
                
                <div id="dictionary-content" style="display: none;">
                    <input type="text" id="search-word" placeholder="–ü–æ—à—É–∫ —Å–ª–æ–≤–∞...">
                    
                    <table id="word-table">
                        <thead>
                            <tr>
                                <th>–ê–Ω–≥–ª—ñ–π—Å—å–∫–∞</th>
                                <th>–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</th>
                                <th>–†—ñ–≤–µ–Ω—å</th>
                                <th>–ù–∞—Å—Ç—É–ø–Ω–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è</th>
                                <th>–î—ñ—ó</th>
                            </tr>
                        </thead>
                        <tbody id="word-list"></tbody>
                    </table>
                </div>
            </div>
            
            <div id="add" class="tab-content">
                <h2>–î–æ–¥–∞—Ç–∏ –Ω–æ–≤–µ —Å–ª–æ–≤–æ</h2>
                <form id="add-word-form">
                    <div class="form-row">
                        <input type="text" id="new-english" placeholder="–°–ª–æ–≤–æ –∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é" required>
                        <input type="text" id="new-ukrainian" placeholder="–ü–µ—Ä–µ–∫–ª–∞–¥ —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é" required>
                    </div>
                    <button type="submit">–î–æ–¥–∞—Ç–∏</button>
                </form>
                
                <h3 style="margin-top: 20px;">–ü–∞–∫–µ—Ç–Ω–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è</h3>
                <p>–í–≤–µ–¥—ñ—Ç—å —Å–ª–æ–≤–∞ —É —Ñ–æ—Ä–º–∞—Ç—ñ "–∞–Ω–≥–ª—ñ–π—Å—å–∫–µ —Å–ª–æ–≤–æ = —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–π –ø–µ—Ä–µ–∫–ª–∞–¥", –∫–æ–∂–Ω–∞ –ø–∞—Ä–∞ –∑ –Ω–æ–≤–æ–≥–æ —Ä—è–¥–∫–∞</p>
                <textarea id="batch-words" rows="5" style="width: 100%; padding: 10px;"></textarea>
                <button id="add-batch">–î–æ–¥–∞—Ç–∏ –ø–∞–∫–µ—Ç–Ω–æ</button>
            </div>
            
            <div id="stats" class="tab-content">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-value" id="total-words">0</div>
                        <div class="stat-label">–í—Å—å–æ–≥–æ —Å–ª—ñ–≤</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="mastered-words">0</div>
                        <div class="stat-label">–í–∏–≤—á–µ–Ω–æ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="learning-words">0</div>
                        <div class="stat-label">–í –ø—Ä–æ—Ü–µ—Å—ñ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="due-today">0</div>
                        <div class="stat-label">–ù–∞ —Å—å–æ–≥–æ–¥–Ω—ñ</div>
                    </div>
                </div>
                
                <h3 style="margin-top: 20px;">–ï–∫—Å–ø–æ—Ä—Ç/–Ü–º–ø–æ—Ä—Ç</h3>
                <div style="display: flex; gap: 10px;">
                    <button id="export-btn">–ï–∫—Å–ø–æ—Ä—Ç —Å–ª–æ–≤–Ω–∏–∫–∞</button>
                    <button id="import-btn">–Ü–º–ø–æ—Ä—Ç —Å–ª–æ–≤–Ω–∏–∫–∞</button>
                </div>
                <input type="file" id="import-file" style="display: none;">
            </div>
        </div>
    </div>

    <script>
        // –ú–æ–¥–µ–ª—å –¥–∞–Ω–∏—Ö
        class Word {
            constructor(english, ukrainian, level = 0, nextReview = new Date(), history = []) {
                this.english = english;
                this.ukrainian = ukrainian;
                this.level = level; // 0-10, –¥–µ 10 - –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–∏–≤—á–µ–Ω–æ
                this.nextReview = new Date(nextReview);
                this.history = history; // –Ü—Å—Ç–æ—Ä—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π [{ date, success }]
            }
        }

        class VocabularyApp {
            constructor() {
                this.words = [];
                this.currentIndex = 0;
                this.dueTodayWords = [];
                
                this.loadFromLocalStorage();
                this.setupEventListeners();
                this.updateStats();
                this.showTab('practice');
                this.updateDueWords();
            }
            
            loadFromLocalStorage() {
                const savedWords = localStorage.getItem('vocabulary-words');
                if (savedWords) {
                    this.words = JSON.parse(savedWords).map(word => {
                        return new Word(
                            word.english,
                            word.ukrainian || word.russian, // –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ —Å—Ç–∞—Ä–∏—Ö –¥–∞–Ω–∏—Ö
                            word.level,
                            word.nextReview,
                            word.history || []
                        );
                    });
                    // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Ä—è–¥–∫–∏ –¥–∞—Ç –Ω–∞–∑–∞–¥ –≤ –æ–±'—î–∫—Ç–∏ Date
                    this.words.forEach(word => {
                        word.nextReview = new Date(word.nextReview);
                        if (word.history) {
                            word.history.forEach(h => {
                                h.date = new Date(h.date);
                            });
                        }
                    });
                }
            }
            
            saveToLocalStorage() {
                localStorage.setItem('vocabulary-words', JSON.stringify(this.words));
            }
            
            addWord(english, ukrainian) {
                // –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –Ω–∞ –¥—É–±–ª—ñ–∫–∞—Ç–∏
                const existingWord = this.words.find(w => w.english.toLowerCase() === english.toLowerCase());
                if (existingWord) {
                    alert('–¶–µ —Å–ª–æ–≤–æ –≤–∂–µ —î –≤ —Å–ª–æ–≤–Ω–∏–∫—É!');
                    return false;
                }
                
                const newWord = new Word(english, ukrainian);
                this.words.push(newWord);
                this.saveToLocalStorage();
                this.updateWordList();
                this.updateStats();
                this.updateDueWords();
                return true;
            }
            
            updateWord(index, english, ukrainian) {
                if (index >= 0 && index < this.words.length) {
                    this.words[index].english = english;
                    this.words[index].ukrainian = ukrainian;
                    this.saveToLocalStorage();
                    this.updateWordList();
                }
            }
            
            deleteWord(index) {
                if (index >= 0 && index < this.words.length) {
                    this.words.splice(index, 1);
                    this.saveToLocalStorage();
                    this.updateWordList();
                    this.updateStats();
                    this.updateDueWords();
                }
            }
            
            updateDueWords() {
                const now = new Date();
                this.dueTodayWords = this.words
                    .filter(word => word.nextReview <= now)
                    .sort((a, b) => a.nextReview - b.nextReview);
                
                // –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫ –Ω–∞ –≤–∫–ª–∞–¥—Ü—ñ –ø—Ä–∞–∫—Ç–∏–∫–∏
                document.getElementById('due-today').textContent = this.dueTodayWords.length;
                
                // –ü–æ–∫–∞–∑—É—î–º–æ/–ø—Ä–∏—Ö–æ–≤—É—î–º–æ –≤–º—ñ—Å—Ç –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —Å–ª—ñ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è
                const emptyState = document.getElementById('practice-empty');
                const content = document.getElementById('practice-content');
                
                if (this.dueTodayWords.length > 0) {
                    emptyState.style.display = 'none';
                    content.style.display = 'block';
                    this.currentIndex = 0;
                    this.showCurrentWord();
                } else {
                    emptyState.style.display = 'block';
                    content.style.display = 'none';
                }
            }
            
            showCurrentWord() {
                if (this.dueTodayWords.length === 0) return;
                
                const word = this.dueTodayWords[this.currentIndex];
                document.getElementById('word-english').textContent = word.english;
                document.getElementById('word-ukrainian').textContent = word.ukrainian;
                
                // –°–∫–∏–¥–∞—î–º–æ —Å—Ç–∞–Ω –∫–∞—Ä—Ç–∫–∏
                document.getElementById('flashcard').classList.remove('flipped');
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—É
                const progress = ((this.currentIndex + 1) / this.dueTodayWords.length) * 100;
                document.getElementById('practice-progress').style.width = progress + '%';
            }
            
            reviewWord(remembered) {
                if (this.dueTodayWords.length === 0) return;
                
                const word = this.dueTodayWords[this.currentIndex];
                const wordIndex = this.words.findIndex(w => w.english === word.english);
                
                // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ —ñ—Å—Ç–æ—Ä—ñ—é –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ
                if (!word.history) word.history = [];
                word.history.push({
                    date: new Date(),
                    success: remembered
                });
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Ä—ñ–≤–µ–Ω—å –∑–Ω–∞–Ω–Ω—è —Ç–∞ –¥–∞—Ç—É –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è
                if (remembered) {
                    word.level = Math.min(10, word.level + 1);
                } else {
                    word.level = Math.max(0, word.level - 1);
                }
                
                // –†–æ–∑—Ä–∞—Ö–æ–≤—É—î–º–æ —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ä—ñ–≤–Ω—è –∑–Ω–∞–Ω–Ω—è
                let nextInterval = 0;
                switch (word.level) {
                    case 0: nextInterval = 0; break;  // –Ω–µ–≥–∞–π–Ω–æ
                    case 1: nextInterval = 1; break;  // 1 –≥–æ–¥–∏–Ω–∞
                    case 2: nextInterval = 3; break;  // 3 –≥–æ–¥–∏–Ω–∏
                    case 3: nextInterval = 8; break;  // 8 –≥–æ–¥–∏–Ω
                    case 4: nextInterval = 24; break; // 1 –¥–µ–Ω—å
                    case 5: nextInterval = 48; break; // 2 –¥–Ω—ñ
                    case 6: nextInterval = 72; break; // 3 –¥–Ω—ñ
                    case 7: nextInterval = 7 * 24; break; // 1 —Ç–∏–∂–¥–µ–Ω—å
                    case 8: nextInterval = 14 * 24; break; // 2 —Ç–∏–∂–Ω—ñ
                    case 9: nextInterval = 30 * 24; break; // 1 –º—ñ—Å—è—Ü—å
                    case 10: nextInterval = 90 * 24; break; // 3 –º—ñ—Å—è—Ü—ñ
                }
                
                // –í—Å—Ç–∞–Ω–æ–≤–ª—é—î–º–æ –¥–∞—Ç—É –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è
                word.nextReview = new Date(Date.now() + nextInterval * 60 * 60 * 1000);
                
                // –û–Ω–æ–≤–ª—é—î–º–æ —Å–ª–æ–≤–æ –≤ –º–∞—Å–∏–≤—ñ
                this.words[wordIndex] = word;
                this.saveToLocalStorage();
                
                // –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –¥–æ –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ —Å–ª–æ–≤–∞ –∞–±–æ –∑–∞–≤–µ—Ä—à—É—î–º–æ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è
                this.currentIndex++;
                if (this.currentIndex >= this.dueTodayWords.length) {
                    this.updateDueWords(); // –û–Ω–æ–≤–ª—é—î–º–æ —Å–ø–∏—Å–æ–∫ —Å–ª—ñ–≤ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è
                    alert('–í—ñ—Ç–∞—î–º–æ! –í–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏ –≤—Å—ñ –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è –Ω–∞ —Å—å–æ–≥–æ–¥–Ω—ñ.');
                    this.currentIndex = 0;
                } else {
                    this.showCurrentWord();
                }
                
                this.updateStats();
                this.updateWordList();
            }
            
            updateWordList() {
                const wordListEl = document.getElementById('word-list');
                const dictionaryContent = document.getElementById('dictionary-content');
                const dictionaryEmpty = document.getElementById('dictionary-empty');
                
                if (this.words.length === 0) {
                    dictionaryContent.style.display = 'none';
                    dictionaryEmpty.style.display = 'block';
                    return;
                } else {
                    dictionaryContent.style.display = 'block';
                    dictionaryEmpty.style.display = 'none';
                }
                
                // –û—á–∏—â–∞—î–º–æ —Å–ø–∏—Å–æ–∫
                wordListEl.innerHTML = '';
                
                // –ó–∞–ø–æ–≤–Ω—é—î–º–æ —Å–ø–∏—Å–æ–∫ —Å–ª—ñ–≤
                const searchTerm = document.getElementById('search-word').value.toLowerCase();
                
                const filteredWords = searchTerm 
                    ? this.words.filter(word => 
                        word.english.toLowerCase().includes(searchTerm) || 
                        word.ukrainian.toLowerCase().includes(searchTerm))
                    : this.words;
                
                filteredWords.forEach((word, index) => {
                    const tr = document.createElement('tr');
                    
                    const getLevelName = (level) => {
                        if (level <= 2) return '–ü–æ—á–∞—Ç–∫—ñ–≤–µ—Ü—å';
                        if (level <= 5) return '–°–µ—Ä–µ–¥–Ω—ñ–π';
                        if (level <= 8) return '–ü—Ä–æ—Å—É–Ω—É—Ç–∏–π';
                        return '–ú–∞–π—Å—Ç–µ—Ä';
                    };
                    
                    const formatDate = (date) => {
                        const now = new Date();
                        const diff = date - now;
                        
                        // –Ø–∫—â–æ –¥–∞—Ç–∞ –≤ –º–∏–Ω—É–ª–æ–º—É
                        if (diff < 0) return '–ó–∞—Ä–∞–∑';
                        
                        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                        
                        if (days > 0) {
                            return `–ß–µ—Ä–µ–∑ ${days} –¥–Ω.`;
                        } else {
                            return `–ß–µ—Ä–µ–∑ ${hours} –≥–æ–¥.`;
                        }
                    };
                    
                    tr.innerHTML = `
                        <td>${word.english}</td>
                        <td>${word.ukrainian}</td>
                        <td>${getLevelName(word.level)} (${word.level}/10)</td>
                        <td>${formatDate(word.nextReview)}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="edit-word" data-index="${index}">‚úèÔ∏è</button>
                                <button class="delete-word" data-index="${index}">üóëÔ∏è</button>
                            </div>
                        </td>
                    `;
                    
                    wordListEl.appendChild(tr);
                });
                
                // –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –¥–ª—è –∫–Ω–æ–ø–æ–∫ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ç–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è
                document.querySelectorAll('.edit-word').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        const word = this.words[index];
                        
                        const englishPrompt = prompt('–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –∞–Ω–≥–ª—ñ–π—Å—å–∫–µ —Å–ª–æ–≤–æ:', word.english);
                        if (englishPrompt === null) return;
                        
                        const ukrainianPrompt = prompt('–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø–µ—Ä–µ–∫–ª–∞–¥:', word.ukrainian);
                        if (ukrainianPrompt === null) return;
                        
                        this.updateWord(index, englishPrompt, ukrainianPrompt);
                    });
                });
                
                document.querySelectorAll('.delete-word').forEach(button => {
                    button.addEventListener('click', (e) => {
                        const index = parseInt(e.target.getAttribute('data-index'));
                        const word = this.words[index];
                        
                        if (confirm(`–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Å–ª–æ–≤–æ "${word.english}"?`)) {
                            this.deleteWord(index);
                        }
                    });
                });
            }
            
            updateStats() {
                const totalWords = this.words.length;
                const masteredWords = this.words.filter(word => word.level >= 8).length;
                const learningWords = totalWords - masteredWords;
                
                document.getElementById('total-words').textContent = totalWords;
                document.getElementById('mastered-words').textContent = masteredWords;
                document.getElementById('learning-words').textContent = learningWords;
            }
            
            showTab(tabName) {
                // –ê–∫—Ç–∏–≤—É—î–º–æ –ø–æ—Ç—Ä—ñ–±–Ω—É –≤–∫–ª–∞–¥–∫—É
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelector(`.tab[data-tab="${tabName}"]`).classList.add('active');
                
                // –ü–æ–∫–∞–∑—É—î–º–æ –≤–º—ñ—Å—Ç –ø–æ—Ç—Ä—ñ–±–Ω–æ—ó –≤–∫–ª–∞–¥–∫–∏
                document.querySelectorAll('.tab-content').forEach(content => {
                    content.classList.remove('active');
                });
                document.getElementById(tabName).classList.add('active');
                
                // –í–∏–∫–æ–Ω—É—î–º–æ —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω—ñ –¥—ñ—ó –¥–ª—è –∫–æ–∂–Ω–æ—ó –≤–∫–ª–∞–¥–∫–∏
                if (tabName === 'dictionary') {
                    this.updateWordList();
                } else if (tabName === 'practice') {
                    this.updateDueWords();
                } else if (tabName === 'stats') {
                    this.updateStats();
                }
            }
            
            exportDictionary() {
                const dataStr = JSON.stringify(this.words);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = 'vocabulary-export.json';
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
            }
            
            importDictionary(fileContent) {
                try {
                    const importedWords = JSON.parse(fileContent);
                    
                    if (!Array.isArray(importedWords)) {
                        throw new Error('–ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞–Ω–∏—Ö');
                    }
                    
                    // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–∂–Ω–æ–≥–æ —Å–ª–æ–≤–∞
                    importedWords.forEach(word => {
                        if (!word.english || (!word.ukrainian && !word.russian)) {
                            throw new Error('–ù–µ–≤—ñ—Ä–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–∏—Ö');
                        }
                    });
                    
                    // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω—ñ –¥–∞–Ω—ñ
                    const processedWords = importedWords.map(word => {
                        return new Word(
                            word.english,
                            word.ukrainian || word.russian || "",
                            word.level || 0,
                            word.nextReview || new Date(),
                            word.history || []
                        );
                    });
                    
                    // –ó–∞–ø–∏—Ç—É—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, —á–∏ —Ö–æ—á–µ –≤—ñ–Ω –∑–∞–º—ñ–Ω–∏—Ç–∏ –∞–±–æ –æ–±'—î–¥–Ω–∞—Ç–∏ —Å–ª–æ–≤–Ω–∏–∫
                    const choice = confirm('–ó–∞–º—ñ–Ω–∏—Ç–∏ —ñ—Å–Ω—É—é—á–∏–π —Å–ª–æ–≤–Ω–∏–∫? –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å OK –¥–ª—è –∑–∞–º—ñ–Ω–∏ –∞–±–æ –°–∫–∞—Å—É–≤–∞—Ç–∏ –¥–ª—è –æ–±\'—î–¥–Ω–∞–Ω–Ω—è.');
                    
                    if (choice) {
                        // –ó–∞–º—ñ–Ω–∞ —Å–ª–æ–≤–Ω–∏–∫–∞
                        this.words = processedWords;
                    } else {
                        // –û–±'—î–¥–Ω–∞–Ω–Ω—è —Å–ª–æ–≤–Ω–∏–∫—ñ–≤
                        // –î–æ–¥–∞—î–º–æ –ª–∏—à–µ –Ω–æ–≤—ñ —Å–ª–æ–≤–∞
                        processedWords.forEach(newWord => {
                            const existingIndex = this.words.findIndex(w => 
                                w.english.toLowerCase() === newWord.english.toLowerCase());
                                
                            if (existingIndex === -1) {
                                this.words.push(newWord);
                            }
                        });
                    }
                    
                    // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ —Ä—è–¥–∫–∏ –¥–∞—Ç –Ω–∞–∑–∞–¥ –≤ –æ–±'—î–∫—Ç–∏ Date
                    this.words.forEach(word => {
                        word.nextReview = new Date(word.nextReview);
                        if (word.history) {
                            word.history.forEach(h => {
                                h.date = new Date(h.date);
                            });
                        }
                    });
                    
                    this.saveToLocalStorage();
                    this.updateWordList();
                    this.updateStats();
                    this.updateDueWords();
                    
                    alert('–Ü–º–ø–æ—Ä—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!');
                } catch (error) {
                    alert('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —ñ–º–ø–æ—Ä—Ç—ñ: ' + error.message);
                }
            }
            
            setupEventListeners() {
                // –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        const tabName = e.target.getAttribute('data-tab');
                        this.showTab(tabName);
                    });
                });
                
                // –û–±—Ä–æ–±–Ω–∏–∫ —Ñ–æ—Ä–º–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Å–ª–æ–≤–∞
                document.getElementById('add-word-form').addEventListener('submit', (e) => {
                    e.preventDefault();
                    
                    const englishInput = document.getElementById('new-english');
                    const ukrainianInput = document.getElementById('new-ukrainian');
                    
                    const english = englishInput.value.trim();
                    const ukrainian = ukrainianInput.value.trim();
                    
                    if (english && ukrainian) {
                        if (this.addWord(english, ukrainian)) {
                            // –û—á–∏—â–∞—î–º–æ –ø–æ–ª—è –≤–≤–æ–¥—É —Ç—ñ–ª—å–∫–∏ —è–∫—â–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –ø—Ä–æ–π—à–ª–æ —É—Å–ø—ñ—à–Ω–æ
                            englishInput.value = '';
                            ukrainianInput.value = '';
                        }
                    }
                });
                
                // –û–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Å–ª—ñ–≤
                document.getElementById('add-batch').addEventListener('click', () => {
                    const batchText = document.getElementById('batch-words').value.trim();
                    
                    if (!batchText